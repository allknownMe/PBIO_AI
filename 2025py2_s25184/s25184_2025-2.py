from Bio import Entrez, SeqIO;from io import StringIO as S;import pandas as p,matplotlib.pyplot as m;E=input("Email: ");K=input("Key: ");T=input("TaxID: ");L=int(input("Min: "));H=int(input("Max: "));Entrez.email=E;Entrez.api_key=K;r=Entrez.read(Entrez.esearch(db="nucleotide",term=f"txid{T}[Organism]",retmax=500,usehistory="y"));a=Entrez.efetch(db="nucleotide",rettype="gb",retmode="text",retstart=0,retmax=500,webenv=r["WebEnv"],query_key=r["QueryKey"]);d=[(x.id,len(x.seq),x.description)for x in SeqIO.parse(S(a.read()),"genbank")if L<=len(x.seq)<=H];df=p.DataFrame(d,columns=["a","l","d"]).sort_values("l",ascending=0);df.to_csv(f"s25184_taxid{T}.csv",index=0);df.plot(x="a",y="l",kind="line",legend=0,rot=90);m.tight_layout();m.savefig(f"s25184_taxid{T}.png")